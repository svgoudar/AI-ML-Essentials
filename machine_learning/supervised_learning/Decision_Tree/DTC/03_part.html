
<!DOCTYPE html>


<html lang="en" data-content_root="../../../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Hyperparameters Tuning &#8212; Machine Learning Handbook</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css?v=6644e6bb" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/tabs.css?v=4c969af8" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/proof.css?v=b4b7a797" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/styles/sphinx-examples.css?v=e236af4b" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/css/tooltipster.custom.css?v=7bc2f056" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/css/tooltipster.bundle.min.css?v=37217874" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/css/tooltipster-sideTip-shadow.min.css?v=6227e517" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/css/tooltipster-sideTip-punk.min.css?v=94669e23" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/css/tooltipster-sideTip-noir.min.css?v=21a39f42" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/css/tooltipster-sideTip-light.min.css?v=a18b2449" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/css/tooltipster-sideTip-borderless.min.css?v=dbff53e4" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/css/micromodal.css?v=d7bf34ee" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/custom.css?v=6528377c" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../../../_static/jquery.js?v=5d32c60e"></script>
    <script src="../../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
    <script src="../../../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../../../_static/copybutton.js?v=7f8ff830"></script>
    <script src="../../../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script src="../../../../_static/tabs.js?v=3ee01567"></script>
    <script src="../../../../_static/js/hoverxref.js?v=c95ade4f"></script>
    <script src="../../../../_static/js/tooltipster.bundle.min.js?v=18bf091b"></script>
    <script src="../../../../_static/js/micromodal.min.js?v=04d6302d"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"tex": {"macros": {"N": "\\mathbb{N}", "floor": ["\\lfloor#1\\rfloor", 1], "bmat": ["\\left[\\begin{array}"], "emat": ["\\end{array}\\right]"]}}, "options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'machine_learning/supervised_learning/Decision_Tree/DTC/03_part';</script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="Handle Underfitting/Overfitting" href="04_part.html" />
    <link rel="prev" title="Performance Metrics" href="02_part.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../../../introduction.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../../../_static/logo.png" class="logo__image only-light" alt="Machine Learning Handbook - Home"/>
    <script>document.write(`<img src="../../../../_static/logo.png" class="logo__image only-dark" alt="Machine Learning Handbook - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../../../introduction.html">
                    Machine Learning
                </a>
            </li>
        </ul>
        <ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Linear_Regression/overview.html">Linear Regression</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Linear_Regression/01_part.html">Overview</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../Linear_Regression/02_part.html">Gradient Descent</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../Linear_Regression/03_part.html">Convergence Algorithm</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../Linear_Regression/04_part.html">Cost Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Linear_Regression/05_part.html">Multiple Linear Regression</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Linear_Regression/06_part.html">Polynomial Regression</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Linear_Regression/07_part.html">Performance Metrics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Linear_Regression/08_part.html">OLS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Linear_Regression/09_part.html">Bias–Variance Tradeoff</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../Linear_Regression/Hyperparameter_Tuning/overview.html">Hyperparameter Tuning in Linear Regression</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../Linear_Regression/Hyperparameter_Tuning/01_part.html">Regularization &amp; Generalization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Linear_Regression/Hyperparameter_Tuning/02_part.html">Lasso Regression</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Linear_Regression/Hyperparameter_Tuning/03_part.html">Ridge Regression</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Linear_Regression/Hyperparameter_Tuning/04_part.html">Elastic Net Regression</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Linear_Regression/Hyperparameter_Tuning/05_part.html">Workflow of Regularized Regression</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Linear_Regression/Hyperparameter_Tuning/06_part.html">Cross-Validation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Linear_Regression/Hyperparameter_Tuning/07_part.html">Hyperparameter Tuning methods</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Linear_Regression/Hyperparameter_Tuning/08_part.html">Handle Overfitting</a></li>
</ul>
</details></li>
</ul>
</details></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Logistic_Regression/overview.html">Logistic Regression</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Logistic_Regression/01_part.html">Assumtpions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Logistic_Regression/02_part.html">Intiution</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Logistic_Regression/03_part.html">Workflows</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Logistic_Regression/04_part.html">Cost Function</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Logistic_Regression/05_part.html">Performance Metrics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Logistic_Regression/06_part.html">One-vs-Rest (OVR) Logistic Regression</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Logistic_Regression/07_part.html">Handling Imabalance dataset</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../Logistic_Regression/HyperParameter_Tuning/overview.html">Hyperparameter Tuning</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../Logistic_Regression/HyperParameter_Tuning/01_part.html">Evaluation Metrics</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Logistic_Regression/HyperParameter_Tuning/02_part.html">Cross Validation</a></li>
</ul>
</details></li>
</ul>
</details></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Support_Vector_Machine/overview.html">SVM</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../Support_Vector_Machine/SVR/overview.html">SVR</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../Support_Vector_Machine/SVR/01_part.html">Cost Function</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Support_Vector_Machine/SVR/02_part.html">Evaluation Metrics</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Support_Vector_Machine/SVR/03_part.html">Hyper-Parameter Intiution</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../Support_Vector_Machine/SVC/overview.html">SVC</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../Support_Vector_Machine/SVC/01_part.html">Cost Function</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Support_Vector_Machine/SVC/02_part.html">Evaluation Metrics</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Support_Vector_Machine/SVC/03_part.html">Hyper-paramter Tuning Intiution</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../../Support_Vector_Machine/01_part.html">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Support_Vector_Machine/02_part.html">Assumptions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Support_Vector_Machine/03_part.html">Intiution</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Support_Vector_Machine/04_part.html">Workflows</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Support_Vector_Machine/05_part.html">Kernels</a></li>
</ul>
</details></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Naive_Bayes/overview.html">Naive Bayes</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Naive_Bayes/01_part.html">Assumptions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Naive_Bayes/02_part.html">Intuition</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Naive_Bayes/03_part.html">Background</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Naive_Bayes/04_part.html">Workflows</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Naive_Bayes/05_part.html">Cost Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Naive_Bayes/06_part.html">Performance Metrics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Naive_Bayes/07_part.html">Variants of NB</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Naive_Bayes/08_part.html">Hyperparameter Tuning</a></li>
</ul>
</details></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../KNN/overview.html">K-Nearest Neighbors (KNN)</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../KNN/01_part.html">Assumptions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../KNN/02_part.html">Intiution</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../KNN/03_part.html">Workflows</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../KNN/04_part.html">How to select cluster <span class="math notranslate nohighlight">\(k\)</span></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../KNN/05_part.html">KNN Variants</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../KNN/06_part.html">Cost Function</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../KNN/07_part.html">Performance Metrics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../KNN/08_part.html">Hyperparameter Tuning</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../KNN/09_part.html">Regression &amp; Classification</a></li>
</ul>
</details></li>
</ul>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../overview.html">Decision Tree</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 has-children"><a class="reference internal" href="../DTR/overview.html">Decision Tree Regressor</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../DTR/01_part.html">Cost Functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../DTR/02_part.html">Performance Metrics</a></li>
<li class="toctree-l3"><a class="reference internal" href="../DTR/03_part.html">Hyperparameter tuning</a></li>
</ul>
</details></li>
<li class="toctree-l2 current active has-children"><a class="reference internal" href="overview.html">Decision Tree Classifier</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="01_part.html">Cost Function</a></li>
<li class="toctree-l3"><a class="reference internal" href="02_part.html">Performance Metrics</a></li>
<li class="toctree-l3 current active"><a class="current reference internal" href="#">Hyperparameters Tuning</a></li>



<li class="toctree-l3"><a class="reference internal" href="04_part.html">Handle Underfitting/Overfitting</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../01_part.html">Assumptions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../02_part.html">Purity Measures</a></li>
<li class="toctree-l2"><a class="reference internal" href="../03_part.html">Hyperparameter Tuning in Decision Tree</a></li>




</ul>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://colab.research.google.com/github/svgoudar/AI-ML-Essentials/blob/master/machine_learning/supervised_learning/Decision_Tree/DTC/03_part.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Colab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Colab logo" src="../../../../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/svgoudar/AI-ML-Essentials" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/svgoudar/AI-ML-Essentials/issues/new?title=Issue%20on%20page%20%2Fmachine_learning/supervised_learning/Decision_Tree/DTC/03_part.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../../../_sources/machine_learning/supervised_learning/Decision_Tree/DTC/03_part.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Hyperparameters Tuning</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Hyperparameters Tuning</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#max-depth">1. <strong>max_depth</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#min-samples-split">2. <strong>min_samples_split</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#min-samples-leaf">3. <strong>min_samples_leaf</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#max-features">4. <strong>max_features</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#criterion">5. <strong>criterion</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#max-leaf-nodes">6. <strong>max_leaf_nodes</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#class-weight">7. <strong>class_weight</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ccp-alpha-cost-complexity-pruning">8. <strong>ccp_alpha (Cost Complexity Pruning)</strong></a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#how-to-tune-these">⚖️ How to Tune These?</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#typical-workflow">🎯 Typical Workflow</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#pruning">Pruning</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#types-of-pruning">🛠️ Types of Pruning</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pre-pruning-early-stopping">1. <strong>Pre-Pruning (Early Stopping)</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#post-pruning-cost-complexity-pruning">2. <strong>Post-Pruning (Cost Complexity Pruning)</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#when-to-use-which">When to Use Which</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <nav class="contents" id="contents" role="doc-toc">
<p class="topic-title">Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#hyperparameters-tuning" id="id1">Hyperparameters Tuning</a></p>
<ul>
<li><p><a class="reference internal" href="#max-depth" id="id2">1. <strong>max_depth</strong></a></p></li>
<li><p><a class="reference internal" href="#min-samples-split" id="id3">2. <strong>min_samples_split</strong></a></p></li>
<li><p><a class="reference internal" href="#min-samples-leaf" id="id4">3. <strong>min_samples_leaf</strong></a></p></li>
<li><p><a class="reference internal" href="#max-features" id="id5">4. <strong>max_features</strong></a></p></li>
<li><p><a class="reference internal" href="#criterion" id="id6">5. <strong>criterion</strong></a></p></li>
<li><p><a class="reference internal" href="#max-leaf-nodes" id="id7">6. <strong>max_leaf_nodes</strong></a></p></li>
<li><p><a class="reference internal" href="#class-weight" id="id8">7. <strong>class_weight</strong></a></p></li>
<li><p><a class="reference internal" href="#ccp-alpha-cost-complexity-pruning" id="id9">8. <strong>ccp_alpha (Cost Complexity Pruning)</strong></a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#how-to-tune-these" id="id10">⚖️ How to Tune These?</a></p></li>
<li><p><a class="reference internal" href="#typical-workflow" id="id11">🎯 Typical Workflow</a></p></li>
<li><p><a class="reference internal" href="#pruning" id="id12">Pruning</a></p>
<ul>
<li><p><a class="reference internal" href="#types-of-pruning" id="id13">🛠️ Types of Pruning</a></p>
<ul>
<li><p><a class="reference internal" href="#pre-pruning-early-stopping" id="id14">1. <strong>Pre-Pruning (Early Stopping)</strong></a></p></li>
<li><p><a class="reference internal" href="#post-pruning-cost-complexity-pruning" id="id15">2. <strong>Post-Pruning (Cost Complexity Pruning)</strong></a></p></li>
<li><p><a class="reference internal" href="#when-to-use-which" id="id16">When to Use Which</a></p></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
<section id="hyperparameters-tuning">
<h1><a class="toc-backref" href="#id1" role="doc-backlink">Hyperparameters Tuning</a><a class="headerlink" href="#hyperparameters-tuning" title="Link to this heading">#</a></h1>
<section id="max-depth">
<h2><a class="toc-backref" href="#id2" role="doc-backlink">1. <strong>max_depth</strong></a><a class="headerlink" href="#max-depth" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Controls how deep the tree can grow.</p></li>
<li><p><strong>Small depth</strong> → underfitting (too simple).</p></li>
<li><p><strong>Large depth</strong> → overfitting (memorizes training data).</p></li>
<li><p>🔑 Tip: Tune using cross-validation. Typical values = <code class="docutils literal notranslate"><span class="pre">3–15</span></code>.</p></li>
</ul>
</section>
<hr class="docutils" />
<section id="min-samples-split">
<h2><a class="toc-backref" href="#id3" role="doc-backlink">2. <strong>min_samples_split</strong></a><a class="headerlink" href="#min-samples-split" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Minimum number of samples required to split an internal node.</p></li>
<li><p>Prevents splitting when not enough data supports it.</p></li>
<li><p>Higher values = more conservative trees.</p></li>
</ul>
</section>
<hr class="docutils" />
<section id="min-samples-leaf">
<h2><a class="toc-backref" href="#id4" role="doc-backlink">3. <strong>min_samples_leaf</strong></a><a class="headerlink" href="#min-samples-leaf" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Minimum samples required in a leaf node.</p></li>
<li><p>Ensures leaves have enough data (prevents tiny, noisy leaves).</p></li>
<li><p>Often set between <code class="docutils literal notranslate"><span class="pre">1–5%</span></code> of dataset size.</p></li>
</ul>
</section>
<hr class="docutils" />
<section id="max-features">
<h2><a class="toc-backref" href="#id5" role="doc-backlink">4. <strong>max_features</strong></a><a class="headerlink" href="#max-features" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Number of features to consider when looking for the best split.</p></li>
<li><p>Options:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;sqrt&quot;</span></code> (good for classification)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;log2&quot;</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">None</span></code> (use all features)</p></li>
</ul>
</li>
<li><p>Helps reduce variance &amp; speed up training.</p></li>
</ul>
</section>
<hr class="docutils" />
<section id="criterion">
<h2><a class="toc-backref" href="#id6" role="doc-backlink">5. <strong>criterion</strong></a><a class="headerlink" href="#criterion" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Metric used to measure quality of split.</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;gini&quot;</span></code> (default, faster).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;entropy&quot;</span></code> (uses log, more computationally heavy).</p></li>
</ul>
</li>
<li><p>Both usually give similar results.</p></li>
</ul>
</section>
<hr class="docutils" />
<section id="max-leaf-nodes">
<h2><a class="toc-backref" href="#id7" role="doc-backlink">6. <strong>max_leaf_nodes</strong></a><a class="headerlink" href="#max-leaf-nodes" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Restricts the number of leaf nodes.</p></li>
<li><p>Controls complexity similar to <code class="docutils literal notranslate"><span class="pre">max_depth</span></code>.</p></li>
</ul>
</section>
<hr class="docutils" />
<section id="class-weight">
<h2><a class="toc-backref" href="#id8" role="doc-backlink">7. <strong>class_weight</strong></a><a class="headerlink" href="#class-weight" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Adjusts weight for imbalanced datasets.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;balanced&quot;</span></code> makes class weights inversely proportional to class frequencies.</p></li>
</ul>
</section>
<hr class="docutils" />
<section id="ccp-alpha-cost-complexity-pruning">
<h2><a class="toc-backref" href="#id9" role="doc-backlink">8. <strong>ccp_alpha (Cost Complexity Pruning)</strong></a><a class="headerlink" href="#ccp-alpha-cost-complexity-pruning" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Controls pruning (removing branches that don’t improve performance).</p></li>
<li><p>Higher values prune more → simpler tree.</p></li>
</ul>
<hr class="docutils" />
</section>
</section>
<section id="how-to-tune-these">
<h1><a class="toc-backref" href="#id10" role="doc-backlink">⚖️ How to Tune These?</a><a class="headerlink" href="#how-to-tune-these" title="Link to this heading">#</a></h1>
<ol class="arabic simple">
<li><p><strong>Manual Grid Search</strong> → Try combinations of hyperparameters.</p></li>
<li><p><strong>Randomized Search CV</strong> → Faster, samples random combinations.</p></li>
<li><p><strong>Bayesian Optimization / AutoML</strong> → Advanced approaches (e.g., Optuna, Hyperopt).</p></li>
</ol>
<hr class="docutils" />
</section>
<section id="typical-workflow">
<h1><a class="toc-backref" href="#id11" role="doc-backlink">🎯 Typical Workflow</a><a class="headerlink" href="#typical-workflow" title="Link to this heading">#</a></h1>
<ol class="arabic simple">
<li><p>Start with a baseline model (<code class="docutils literal notranslate"><span class="pre">DecisionTreeClassifier()</span></code> default).</p></li>
<li><p>Use <strong>cross-validation</strong> with <code class="docutils literal notranslate"><span class="pre">GridSearchCV</span></code> or <code class="docutils literal notranslate"><span class="pre">RandomizedSearchCV</span></code>.</p></li>
<li><p>Tune: <code class="docutils literal notranslate"><span class="pre">max_depth</span></code>, <code class="docutils literal notranslate"><span class="pre">min_samples_split</span></code>, <code class="docutils literal notranslate"><span class="pre">min_samples_leaf</span></code>, <code class="docutils literal notranslate"><span class="pre">max_features</span></code>.</p></li>
<li><p>Apply pruning (<code class="docutils literal notranslate"><span class="pre">ccp_alpha</span></code>).</p></li>
<li><p>Evaluate with metrics (Accuracy, F1, ROC-AUC depending on dataset balance).</p></li>
</ol>
<hr class="docutils" />
<p>👉 In short:</p>
<ul class="simple">
<li><p>If your tree is <strong>too complex</strong>, control it with <code class="docutils literal notranslate"><span class="pre">max_depth</span></code>, <code class="docutils literal notranslate"><span class="pre">min_samples_leaf</span></code>, or pruning.</p></li>
<li><p>If it’s <strong>too simple</strong>, reduce constraints.</p></li>
<li><p>Use cross-validation to find the <strong>sweet spot</strong>.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">load_iris</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.model_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">train_test_split</span><span class="p">,</span> <span class="n">GridSearchCV</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.tree</span><span class="w"> </span><span class="kn">import</span> <span class="n">DecisionTreeClassifier</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">accuracy_score</span><span class="p">,</span> <span class="n">classification_report</span><span class="p">,</span> <span class="n">confusion_matrix</span>

<span class="c1"># Load dataset</span>
<span class="n">iris</span> <span class="o">=</span> <span class="n">load_iris</span><span class="p">()</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">iris</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">iris</span><span class="o">.</span><span class="n">target</span>

<span class="c1"># Train-test split</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span>
    <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">stratify</span><span class="o">=</span><span class="n">y</span>
<span class="p">)</span>

<span class="c1"># Base model</span>
<span class="n">dtc</span> <span class="o">=</span> <span class="n">DecisionTreeClassifier</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

<span class="c1"># Define hyperparameter grid</span>
<span class="n">param_grid</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;criterion&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;gini&#39;</span><span class="p">,</span> <span class="s1">&#39;entropy&#39;</span><span class="p">],</span>
    <span class="s1">&#39;max_depth&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="kc">None</span><span class="p">],</span>
    <span class="s1">&#39;min_samples_split&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span>
    <span class="s1">&#39;min_samples_leaf&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
<span class="p">}</span>

<span class="c1"># GridSearchCV</span>
<span class="n">grid_search</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span>
    <span class="n">estimator</span><span class="o">=</span><span class="n">dtc</span><span class="p">,</span>
    <span class="n">param_grid</span><span class="o">=</span><span class="n">param_grid</span><span class="p">,</span>
    <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
    <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;accuracy&#39;</span><span class="p">,</span>
    <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span>
<span class="p">)</span>

<span class="n">grid_search</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="c1"># Best model</span>
<span class="n">best_dtc</span> <span class="o">=</span> <span class="n">grid_search</span><span class="o">.</span><span class="n">best_estimator_</span>

<span class="c1"># Predictions</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">best_dtc</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="c1"># Results</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Best Parameters:&quot;</span><span class="p">,</span> <span class="n">grid_search</span><span class="o">.</span><span class="n">best_params_</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Test Accuracy:&quot;</span><span class="p">,</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Classification Report:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">classification_report</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">target_names</span><span class="o">=</span><span class="n">iris</span><span class="o">.</span><span class="n">target_names</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Confusion Matrix:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Fitting 5 folds for each of 90 candidates, totalling 450 fits
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Best Parameters: {&#39;criterion&#39;: &#39;gini&#39;, &#39;max_depth&#39;: 4, &#39;min_samples_leaf&#39;: 1, &#39;min_samples_split&#39;: 2}
Test Accuracy: 0.9333333333333333

Classification Report:
               precision    recall  f1-score   support

      setosa       1.00      1.00      1.00        10
  versicolor       0.90      0.90      0.90        10
   virginica       0.90      0.90      0.90        10

    accuracy                           0.93        30
   macro avg       0.93      0.93      0.93        30
weighted avg       0.93      0.93      0.93        30


Confusion Matrix:
 [[10  0  0]
 [ 0  9  1]
 [ 0  1  9]]
</pre></div>
</div>
</div>
</div>
</section>
<section id="pruning">
<h1><a class="toc-backref" href="#id12" role="doc-backlink">Pruning</a><a class="headerlink" href="#pruning" title="Link to this heading">#</a></h1>
<ul class="simple">
<li><p>A <strong>Decision Tree grows until all leaves are pure</strong> (or meet stopping criteria).</p></li>
<li><p>This often leads to a very <strong>deep and complex tree</strong> → memorizes training data (overfitting).</p></li>
<li><p><strong>Pruning = cutting back branches</strong> that don’t contribute much to predictive power.</p></li>
</ul>
<p>👉 Think of pruning like trimming a plant 🌿: keep only the strong, useful branches.</p>
<hr class="docutils" />
<section id="types-of-pruning">
<h2><a class="toc-backref" href="#id13" role="doc-backlink">🛠️ Types of Pruning</a><a class="headerlink" href="#types-of-pruning" title="Link to this heading">#</a></h2>
<section id="pre-pruning-early-stopping">
<h3><a class="toc-backref" href="#id14" role="doc-backlink">1. <strong>Pre-Pruning (Early Stopping)</strong></a><a class="headerlink" href="#pre-pruning-early-stopping" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Stop tree growth <strong>before</strong> it becomes too complex.</p></li>
<li><p>Controlled by hyperparameters:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">max_depth</span></code> → limit depth.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">min_samples_split</span></code> → minimum samples to split a node.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">min_samples_leaf</span></code> → minimum samples per leaf.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">max_leaf_nodes</span></code> → limit total leaves.</p></li>
</ul>
</li>
<li><p>⚡ Faster but may underfit if you stop too early.</p></li>
</ul>
</section>
<hr class="docutils" />
<section id="post-pruning-cost-complexity-pruning">
<h3><a class="toc-backref" href="#id15" role="doc-backlink">2. <strong>Post-Pruning (Cost Complexity Pruning)</strong></a><a class="headerlink" href="#post-pruning-cost-complexity-pruning" title="Link to this heading">#</a></h3>
<ul>
<li><p>Let the tree grow fully, then <strong>remove unnecessary branches</strong>.</p></li>
<li><p>Based on <strong>Cost Complexity Pruning</strong> (a.k.a. <strong>Minimal Cost-Complexity Pruning</strong>):</p>
<ul>
<li><p>Each subtree has a cost:</p>
<div class="math notranslate nohighlight">
\[
    R_\alpha(T) = R(T) + \alpha \cdot |T|
    \]</div>
<p>where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(R(T)\)</span> = impurity/error of the tree</p></li>
<li><p><span class="math notranslate nohighlight">\(|T|\)</span> = number of leaves (complexity)</p></li>
<li><p><span class="math notranslate nohighlight">\(\alpha\)</span> = complexity penalty parameter</p></li>
</ul>
</li>
</ul>
</li>
<li><p>Larger <span class="math notranslate nohighlight">\(\alpha\)</span> → more pruning → simpler tree.</p></li>
</ul>
</section>
<hr class="docutils" />
<section id="when-to-use-which">
<h3><a class="toc-backref" href="#id16" role="doc-backlink">When to Use Which</a><a class="headerlink" href="#when-to-use-which" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>Pre-pruning</strong> → if dataset is very large, to save time.</p></li>
<li><p><strong>Post-pruning</strong> → if you want a tree to grow fully, then simplify it optimally.</p></li>
<li><p>In practice: <strong>use cost-complexity pruning (<code class="docutils literal notranslate"><span class="pre">ccp_alpha</span></code>)</strong> along with some pre-pruning limits.</p></li>
</ul>
<hr class="docutils" />
<p><strong>Summary</strong>:</p>
<ul class="simple">
<li><p><strong>Pruning = reduce tree size to avoid overfitting</strong>.</p></li>
<li><p><strong>Pre-pruning</strong> stops early with hyperparameters.</p></li>
<li><p><strong>Post-pruning</strong> uses <strong>ccp_alpha</strong> to cut weak branches after training.</p></li>
<li><p>Pruned trees generalize better on unseen data.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">load_iris</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.model_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.tree</span><span class="w"> </span><span class="kn">import</span> <span class="n">DecisionTreeClassifier</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">accuracy_score</span>

<span class="c1"># 1. Load dataset</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">load_iris</span><span class="p">(</span><span class="n">return_X_y</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

<span class="c1"># 2. Train an unpruned decision tree (overfitting possible)</span>
<span class="n">dt_unpruned</span> <span class="o">=</span> <span class="n">DecisionTreeClassifier</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">dt_unpruned</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="n">train_acc_unpruned</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">dt_unpruned</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">))</span>
<span class="n">test_acc_unpruned</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">dt_unpruned</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unpruned Tree → Train Acc: </span><span class="si">{</span><span class="n">train_acc_unpruned</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">, Test Acc: </span><span class="si">{</span><span class="n">test_acc_unpruned</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># 3. Get effective alphas for pruning</span>
<span class="n">path</span> <span class="o">=</span> <span class="n">dt_unpruned</span><span class="o">.</span><span class="n">cost_complexity_pruning_path</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">ccp_alphas</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">ccp_alphas</span>

<span class="c1"># 4. Train trees for different alphas</span>
<span class="n">train_scores</span><span class="p">,</span> <span class="n">test_scores</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">alpha</span> <span class="ow">in</span> <span class="n">ccp_alphas</span><span class="p">:</span>
    <span class="n">dt</span> <span class="o">=</span> <span class="n">DecisionTreeClassifier</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">ccp_alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">)</span>
    <span class="n">dt</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
    <span class="n">train_scores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">dt</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)))</span>
    <span class="n">test_scores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">dt</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)))</span>

<span class="c1"># 5. Plot accuracy vs alpha</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ccp_alphas</span><span class="p">,</span> <span class="n">train_scores</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Train Accuracy&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ccp_alphas</span><span class="p">,</span> <span class="n">test_scores</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Test Accuracy&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;ccp_alpha (pruning strength)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Accuracy&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Effect of Cost Complexity Pruning on Accuracy&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Unpruned Tree → Train Acc: 1.000, Test Acc: 1.000
</pre></div>
</div>
<img alt="../../../../_images/5db290bd38c5b1766df4c333f43dab4383afcc44161bfcdbefb9ca0980160921.png" src="../../../../_images/5db290bd38c5b1766df4c333f43dab4383afcc44161bfcdbefb9ca0980160921.png" />
</div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./machine_learning\supervised_learning\Decision_Tree\DTC"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="02_part.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Performance Metrics</p>
      </div>
    </a>
    <a class="right-next"
       href="04_part.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Handle Underfitting/Overfitting</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Hyperparameters Tuning</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#max-depth">1. <strong>max_depth</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#min-samples-split">2. <strong>min_samples_split</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#min-samples-leaf">3. <strong>min_samples_leaf</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#max-features">4. <strong>max_features</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#criterion">5. <strong>criterion</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#max-leaf-nodes">6. <strong>max_leaf_nodes</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#class-weight">7. <strong>class_weight</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ccp-alpha-cost-complexity-pruning">8. <strong>ccp_alpha (Cost Complexity Pruning)</strong></a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#how-to-tune-these">⚖️ How to Tune These?</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#typical-workflow">🎯 Typical Workflow</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#pruning">Pruning</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#types-of-pruning">🛠️ Types of Pruning</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pre-pruning-early-stopping">1. <strong>Pre-Pruning (Early Stopping)</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#post-pruning-cost-complexity-pruning">2. <strong>Post-Pruning (Cost Complexity Pruning)</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#when-to-use-which">When to Use Which</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By svgoudar
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>